<!DOCTYPE html>
<html lang="en-GB">
<head>
    <meta charset="UTF-8">
    <link rel="icon" type="image/png" sizes="32x32" href="/Images/logo.jpg">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Parent Portal - Baobab Online Academy</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Merriweather:wght@300;400;700;900&family=Open+Sans:wght@300;400;600;700&family=Kalam:wght@400;700&display=swap" rel="stylesheet">
    <!-- Supabase -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <!-- EmailJS -->
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>
    <style>
        :root {
            /* Using main homepage colors */
            --baobab-brown: #8D4004;
            --canopy-green: #2E7D32;
            --sunset-gold: #F57C00;
            --trunk-gray: #5D4037;
            --sky-blue: #1976D2;
            --earth-cream: #FFF8E1;
            --desert-orange: #FF5722;
            --sage-green: #689F38;
            --deep-charcoal: #263238;
            --white: #FFFFFF;
            --glow-color: rgba(245, 124, 0, 0.6);
            
            --transition-slow: all 0.6s cubic-bezier(0.165, 0.84, 0.44, 1);
            --transition-medium: all 0.4s cubic-bezier(0.165, 0.84, 0.44, 1);
            --transition-fast: all 0.3s cubic-bezier(0.165, 0.84, 0.44, 1);
            
            --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.1);
            --shadow-md: 0 4px 6px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Open Sans', sans-serif;
            color: var(--deep-charcoal);
            line-height: 1.6;
            overflow-x: hidden;
            background-color: var(--white);
        }
        
        h1, h2, h3, h4, h5 {
            font-family: 'Merriweather', serif;
            font-weight: 700;
            line-height: 1.3;
        }
        
        .container {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
            position: relative;
        }
        
        .section {
            padding: 80px 0;
            position: relative;
        }
        
        .btn {
            display: inline-flex;
            align-items: center;
            gap: 10px;
            padding: 14px 32px;
            border-radius: 30px;
            font-weight: 600;
            text-align: center;
            transition: var(--transition-fast);
            border: 2px solid transparent;
            font-family: 'Open Sans', sans-serif;
            text-decoration: none;
            cursor: pointer;
        }
        
        .btn-primary {
            background-color: var(--baobab-brown);
            color: var(--white);
            border-color: var(--baobab-brown);
        }
        
        .btn-primary:hover {
            background-color: var(--trunk-gray);
            border-color: var(--trunk-gray);
            transform: translateY(-3px);
            box-shadow: var(--shadow-md);
        }
        
        .btn-secondary {
            background-color: var(--sunset-gold);
            color: var(--deep-charcoal);
            border-color: var(--sunset-gold);
        }
        
        .btn-outlined {
            background-color: transparent;
            color: var(--baobab-brown);
            border-color: var(--baobab-brown);
        }
        
        .btn-outlined:hover {
            background-color: var(--baobab-brown);
            color: var(--white);
        }
        
        /* Header */
        .header {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            z-index: 1000;
            background-color: var(--white);
            box-shadow: var(--shadow-md);
            padding: 10px 0;
        }
        
        .nav-wrapper {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .logo-icon {
            width: 32px;
            height: 32px;
            background-color: var(--canopy-green);
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 8px;
            font-size: 20px;
            color: var(--white);
        }
        
        .logo-text {
            font-weight: 700;
            font-size: 20px;
            color: var(--baobab-brown);
        }
        
        .nav-menu {
            display: flex;
            gap: 30px;
            list-style: none;
        }
        
        .nav-link {
            font-weight: 500;
            color: var(--deep-charcoal);
            text-decoration: none;
            padding: 5px 0;
            transition: var(--transition-fast);
        }
        
        .nav-link:hover,
        .nav-link.active {
            color: var(--sunset-gold);
        }
        
        .nav-buttons {
            display: flex;
            gap: 15px;
        }
        
        .menu-toggle {
            display: none;
            font-size: 24px;
            cursor: pointer;
            color: var(--baobab-brown);
            z-index: 1001;
            transition: var(--transition-fast);
        }
        
        /* Mobile Menu */
        .mobile-menu-panel {
            position: fixed;
            top: 0;
            right: -100%;
            width: 300px;
            height: 100vh;
            background-color: var(--white);
            z-index: 1000;
            padding: 80px 40px 40px;
            transition: var(--transition-medium);
            box-shadow: var(--shadow-xl);
            overflow-y: auto;
        }
        
        .mobile-menu-panel.active {
            right: 0;
        }
        
        .mobile-menu {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .mobile-link {
            font-weight: 500;
            color: var(--deep-charcoal);
            padding: 12px 0;
            border-bottom: 1px solid var(--earth-cream);
            display: block;
            transition: var(--transition-fast);
            text-decoration: none;
        }
        
        .mobile-link:hover {
            color: var(--sunset-gold);
            padding-left: 10px;
        }
        
        .mobile-link.active {
            color: var(--sunset-gold);
        }
        
        .mobile-buttons {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-top: 30px;
        }
        
        .menu-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            z-index: 999;
            opacity: 0;
            visibility: hidden;
            transition: var(--transition-medium);
            backdrop-filter: blur(5px);
        }
        
        .menu-overlay.active {
            opacity: 1;
            visibility: visible;
        }
        
        /* Hero Section */
        .hero {
            min-height: 100vh;
            background: linear-gradient(135deg, var(--canopy-green), var(--baobab-brown));
            display: flex;
            align-items: center;
            color: var(--white);
            padding-top: 80px;
        }
        
        .hero-content {
            max-width: 700px;
        }
        
        .hero-badge {
            background: rgba(255, 255, 255, 0.2);
            padding: 8px 20px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 600;
            margin-bottom: 20px;
            display: inline-block;
        }
        
        .hero-title {
            font-size: 3.2rem;
            margin-bottom: 20px;
            line-height: 1.2;
        }
        
        .hero-subtitle {
            font-size: 1.2rem;
            opacity: 0.9;
            margin-bottom: 40px;
            line-height: 1.6;
        }
        
        .hero-buttons {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
        }
        
        .btn-hero {
            padding: 18px 35px;
            font-size: 1.1rem;
        }
        
        .btn-white {
            background-color: var(--white);
            color: var(--baobab-brown);
            border-color: var(--white);
        }
        
        .btn-white:hover {
            background-color: transparent;
            color: var(--white);
            border-color: var(--white);
        }
        
        /* Features Preview */
        .features-preview {
            background: var(--earth-cream);
            padding: 100px 0;
        }
        
        .section-title {
            text-align: center;
            font-size: 2.8rem;
            color: var(--baobab-brown);
            margin-bottom: 20px;
        }
        
        .section-subtitle {
            text-align: center;
            color: var(--trunk-gray);
            margin-bottom: 60px;
            max-width: 700px;
            margin-left: auto;
            margin-right: auto;
            font-size: 1.1rem;
        }
        
        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 40px;
        }
        
        .feature-card {
            background: var(--white);
            border-radius: 20px;
            padding: 40px;
            box-shadow: var(--shadow-lg);
            transition: var(--transition-medium);
            border: 3px solid transparent;
            text-align: center;
        }
        
        .feature-card:hover {
            transform: translateY(-10px);
            border-color: var(--sunset-gold);
            box-shadow: var(--shadow-xl);
        }
        
        .feature-icon {
            width: 80px;
            height: 80px;
            background: linear-gradient(135deg, var(--canopy-green), var(--sage-green));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--white);
            font-size: 2.2rem;
            margin: 0 auto 25px;
        }
        
        .feature-card:nth-child(2) .feature-icon {
            background: linear-gradient(135deg, var(--sunset-gold), var(--desert-orange));
            color: var(--deep-charcoal);
        }
        
        .feature-card:nth-child(3) .feature-icon {
            background: linear-gradient(135deg, var(--baobab-brown), var(--trunk-gray));
            color: var(--white);
        }
        
        .feature-title {
            font-size: 1.6rem;
            color: var(--deep-charcoal);
            margin-bottom: 15px;
        }
        
        .feature-description {
            color: var(--trunk-gray);
            line-height: 1.7;
            margin-bottom: 20px;
        }
        
        .feature-benefits {
            list-style: none;
            text-align: left;
        }
        
        .feature-benefits li {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
            font-size: 0.95rem;
            color: var(--trunk-gray);
        }
        
        .feature-benefits i {
            color: var(--canopy-green);
            font-size: 1.1rem;
        }
        
        /* How It Works */
        .how-it-works {
            background: var(--white);
            padding: 100px 0;
        }
        
        .steps-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 40px;
            margin-top: 60px;
        }
        
        .step-card {
            text-align: center;
            position: relative;
        }
        
        .step-number {
            width: 60px;
            height: 60px;
            background: var(--sunset-gold);
            color: var(--deep-charcoal);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            font-weight: 700;
            margin: 0 auto 20px;
        }
        
        .step-title {
            font-size: 1.4rem;
            color: var(--deep-charcoal);
            margin-bottom: 15px;
        }
        
        .step-description {
            color: var(--trunk-gray);
            line-height: 1.6;
        }
        
        /* Security & Trust */
        .security-section {
            background: linear-gradient(135deg, var(--baobab-brown), var(--trunk-gray));
            color: var(--white);
            padding: 80px 0;
        }
        
        .security-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 60px;
            align-items: center;
        }
        
        .security-text h2 {
            font-size: 2.5rem;
            margin-bottom: 20px;
        }
        
        .security-text p {
            font-size: 1.1rem;
            opacity: 0.9;
            margin-bottom: 30px;
            line-height: 1.7;
        }
        
        .security-features {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 25px;
        }
        
        .security-item {
            background: rgba(255, 255, 255, 0.1);
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            backdrop-filter: blur(10px);
        }
        
        .security-icon {
            font-size: 2.5rem;
            margin-bottom: 15px;
            color: var(--sunset-gold);
        }
        
        .security-item-title {
            font-size: 1.1rem;
            margin-bottom: 8px;
        }
        
        .security-item-desc {
            font-size: 0.9rem;
            opacity: 0.8;
        }
        
        /* CTA Section */
        .cta-section {
            background: var(--earth-cream);
            padding: 100px 0;
            text-align: center;
        }
        
        .cta-content {
            max-width: 800px;
            margin: 0 auto;
        }
        
        .cta-title {
            font-size: 3rem;
            color: var(--baobab-brown);
            margin-bottom: 20px;
        }
        
        .cta-subtitle {
            font-size: 1.2rem;
            color: var(--trunk-gray);
            margin-bottom: 40px;
            line-height: 1.6;
        }
        
        .cta-buttons {
            display: flex;
            gap: 25px;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        /* Footer */
        .footer {
            background: var(--deep-charcoal);
            color: var(--white);
            padding: 60px 0 30px;
        }
        
        .footer-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 40px;
            margin-bottom: 40px;
        }
        
        .footer-section h4 {
            color: var(--sunset-gold);
            margin-bottom: 20px;
            font-size: 1.2rem;
        }
        
        .footer-link {
            color: rgba(255, 255, 255, 0.7);
            text-decoration: none;
            display: block;
            padding: 8px 0;
            transition: var(--transition-fast);
        }
        
        .footer-link:hover {
            color: var(--sunset-gold);
            padding-left: 5px;
        }
        
        .footer-bottom {
            text-align: center;
            padding-top: 30px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            color: rgba(255, 255, 255, 0.7);
        }
        
        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.85);
            z-index: 2000;
            align-items: center;
            justify-content: center;
            backdrop-filter: blur(5px);
        }

        .modal-content {
            background: var(--white);
            border: 2px solid var(--sunset-gold);
            border-radius: 25px;
            padding: 45px;
            max-width: 500px;
            width: 95%;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.5);
        }

        .modal-close {
            position: absolute;
            top: 20px;
            right: 25px;
            background: none;
            border: none;
            font-size: 1.8rem;
            cursor: pointer;
            color: var(--trunk-gray);
        }

        .modal-title {
            color: var(--baobab-brown);
            margin-bottom: 25px;
            text-align: center;
            font-family: 'Merriweather', serif;
            font-size: 1.8rem;
        }

        .form-group {
            margin-bottom: 25px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            color: var(--deep-charcoal);
            font-weight: 600;
        }

        .form-input {
            width: 100%;
            padding: 15px 18px;
            border: 2px solid rgba(245, 124, 0, 0.3);
            border-radius: 12px;
            font-size: 1rem;
            background: rgba(141, 64, 4, 0.05);
            color: var(--deep-charcoal);
            transition: border-color 0.3s ease;
        }

        .form-input:focus {
            outline: none;
            border-color: var(--sunset-gold);
            background: var(--white);
        }

        .form-submit {
            width: 100%;
            background: var(--baobab-brown);
            color: var(--white);
            border: none;
            padding: 18px;
            border-radius: 12px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition-fast);
            font-family: 'Open Sans', sans-serif;
        }

        .form-submit:hover {
            background: var(--trunk-gray);
            transform: translateY(-2px);
        }

        .form-submit:disabled {
            background: var(--trunk-gray);
            opacity: 0.7;
            cursor: not-allowed;
            transform: none;
        }

        .error-message {
            background: rgba(255, 87, 34, 0.1);
            border: 1px solid var(--desert-orange);
            color: var(--desert-orange);
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            display: none;
        }

        .success-message {
            background: rgba(46, 125, 50, 0.1);
            border: 1px solid var(--canopy-green);
            color: var(--canopy-green);
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            display: none;
        }

        .loading-spinner {
            display: none;
            width: 20px;
            height: 20px;
            border: 2px solid var(--earth-cream);
            border-top: 2px solid var(--sunset-gold);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-left: 10px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .form-toggle {
            text-align: center;
            margin-top: 20px;
            color: var(--trunk-gray);
        }

        .form-toggle a {
            color: var(--sunset-gold);
            text-decoration: none;
            font-weight: 600;
        }

        .form-toggle a:hover {
            text-decoration: underline;
        }

        /* Email Verification Notice */
        .verification-notice {
            background: linear-gradient(135deg, var(--canopy-green), var(--sage-green));
            color: var(--white);
            padding: 30px;
            border-radius: 20px;
            margin: 20px 0;
            text-align: center;
            border: 3px solid var(--sunset-gold);
        }

        .verification-notice h4 {
            margin-bottom: 15px;
            font-size: 1.5rem;
        }

        .verification-notice p {
            margin-bottom: 12px;
            line-height: 1.6;
        }

        .verification-notice .email-icon {
            font-size: 3.5rem;
            margin-bottom: 20px;
            color: var(--sunset-gold);
        }

        .resend-link {
            color: var(--sunset-gold);
            text-decoration: underline;
            cursor: pointer;
            font-weight: 600;
        }

        .resend-link:hover {
            color: var(--white);
        }
        
        /* Responsive */
        @media (max-width: 992px) {
            .menu-toggle {
                display: block;
            }
            
            .nav-menu,
            .nav-buttons {
                display: none;
            }
            
            .section {
                padding: 60px 0;
            }
        }
        
        @media (max-width: 768px) {
            .hero-title {
                font-size: 2.5rem;
            }
            
            .section-title {
                font-size: 2.2rem;
            }
            
            .features-grid {
                grid-template-columns: 1fr;
                gap: 30px;
            }
            
            .feature-card {
                padding: 30px;
            }
            
            .security-content {
                grid-template-columns: 1fr;
                gap: 40px;
            }
            
            .security-features {
                grid-template-columns: 1fr;
                gap: 20px;
            }
            
            .hero-buttons {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .cta-buttons {
                flex-direction: column;
                align-items: center;
            }
            
            .steps-container {
                grid-template-columns: 1fr;
                gap: 30px;
            }
            
            .hero {
                padding: 100px 0 50px;
            }
            
            .hero-content {
                text-align: center;
            }
            
            .container {
                padding: 0 15px;
            }
        }
        
        @media (max-width: 576px) {
            .hero-title {
                font-size: 2rem;
            }
            
            .section-title {
                font-size: 1.8rem;
            }
            
            .cta-title {
                font-size: 2.2rem;
            }
            
            .hero-subtitle,
            .section-subtitle,
            .cta-subtitle {
                font-size: 1rem;
            }
            
            .btn-hero {
                padding: 16px 30px;
                font-size: 1rem;
            }
            
            .feature-icon {
                width: 70px;
                height: 70px;
                font-size: 2rem;
            }
            
            .feature-title {
                font-size: 1.4rem;
            }
            
            .mobile-menu-panel {
                width: 280px;
                padding: 70px 30px 30px;
            }
            
            .logo-text {
                font-size: 18px;
            }

            .modal-content {
                padding: 30px;
                margin: 10px;
            }

            .verification-notice {
                padding: 25px;
                margin: 15px 0;
            }

            .verification-notice .email-icon {
                font-size: 3rem;
                margin-bottom: 15px;
            }

            .verification-notice h4 {
                font-size: 1.3rem;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="container">
            <div class="nav-wrapper">
                <div class="logo">
                    <div class="logo-icon"><i class="fas fa-heart"></i></div>
                    <div class="logo-text">Parent Portal</div>
                </div>
                
                <div class="menu-toggle" id="menuToggle">
                    <i class="fas fa-bars"></i>
                </div>
                
                <ul class="nav-menu">
                    <li><a href="#features" class="nav-link">Features</a></li>
                    <li><a href="#how-it-works" class="nav-link">How It Works</a></li>
                    <li><a href="#security" class="nav-link">Safety & Security</a></li>
                    <li><a href="baobabonlineacademy.com" class="nav-link">Main Site</a></li>
                </ul>
                
                <div class="nav-buttons">
                    <a href="#" class="btn btn-outlined" onclick="openLoginModal()">Login</a>
                    <a href="#" class="btn btn-primary" onclick="openRegistrationModal()">Register</a>
                </div>
            </div>
        </div>
    </header>
    
    <!-- Mobile Menu -->
    <div class="mobile-menu-panel" id="mobileMenuPanel">
        <ul class="mobile-menu">
            <li><a href="#features" class="mobile-link">Features</a></li>
            <li><a href="#how-it-works" class="mobile-link">How It Works</a></li>
            <li><a href="#security" class="mobile-link">Safety & Security</a></li>
            <li><a href="baobabonlineacademy.com" class="mobile-link">Main Site</a></li>
        </ul>
        <div class="mobile-buttons">
            <a href="#" class="btn btn-outlined" onclick="openLoginModal()">Login</a>
            <a href="#" class="btn btn-primary" onclick="openRegistrationModal()">Register</a>
        </div>
    </div>
    
    <div class="menu-overlay" id="menuOverlay"></div>

    <!-- Hero Section -->
    <section class="hero">
        <div class="container">
            <div class="hero-content">
                <div class="hero-badge">
                    <i class="fas fa-shield-alt"></i>
                    Secure Parent Portal • Always Connected
                </div>
                <h1 class="hero-title">Watch Your Child Flourish Every Step of the Way</h1>
                <p class="hero-subtitle">
                    Stay intimately connected to your child's educational journey with real-time progress tracking, 
                    direct tutor communication, and cultural milestone celebrations - all in a secure, 
                    parent-designed portal that honors your family values.
                </p>
                <div class="hero-buttons">
                    <a href="#" class="btn btn-secondary btn-hero" onclick="openRegistrationModal()">
                        <i class="fas fa-user-plus"></i>
                        Create Parent Account
                    </a>
                    <a href="#features" class="btn btn-white btn-hero">
                        <i class="fas fa-eye"></i>
                        See Portal Features
                    </a>
                </div>
            </div>
        </div>
    </section>

    <!-- Features Preview -->
    <section class="features-preview" id="features">
        <div class="container">
            <h2 class="section-title">Everything You Need as a Parent</h2>
            <p class="section-subtitle">
                Designed by parents, for parents - our portal gives you unprecedented insight and control 
                over your child's educational journey while celebrating their cultural heritage.
            </p>
            
            <div class="features-grid">
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-chart-line"></i>
                    </div>
                    <h3 class="feature-title">Real-Time Progress Tracking</h3>
                    <p class="feature-description">
                        Watch your child grow with detailed academic analytics, cultural milestone tracking, 
                        and visual progress reports that show both achievements and areas for support.
                    </p>
                    <ul class="feature-benefits">
                        <li><i class="fas fa-check-circle"></i> Live grade updates and assignment scores</li>
                        <li><i class="fas fa-check-circle"></i> Cultural heritage learning progress</li>
                        <li><i class="fas fa-check-circle"></i> Detailed subject-by-subject analytics</li>
                        <li><i class="fas fa-check-circle"></i> Milestone celebrations and achievements</li>
                    </ul>
                </div>
                
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-comments"></i>
                    </div>
                    <h3 class="feature-title">Direct Tutor Communication</h3>
                    <p class="feature-description">
                        Connect seamlessly with your child's Nigeria-based tutors through secure messaging, 
                        scheduled calls, and regular feedback sessions that keep you in the loop.
                    </p>
                    <ul class="feature-benefits">
                        <li><i class="fas fa-check-circle"></i> Secure messaging with all tutors</li>
                        <li><i class="fas fa-check-circle"></i> Weekly progress video calls</li>
                        <li><i class="fas fa-check-circle"></i> Cultural context discussions</li>
                        <li><i class="fas fa-check-circle"></i> Instant notifications for important updates</li>
                    </ul>
                </div>
                
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-shield-alt"></i>
                    </div>
                    <h3 class="feature-title">Complete Safety Monitoring</h3>
                    <p class="feature-description">
                        Monitor your child's online learning environment with full transparency, 
                        secure interactions, and comprehensive safety features for peace of mind.
                    </p>
                    <ul class="feature-benefits">
                        <li><i class="fas fa-check-circle"></i> Full session monitoring capabilities</li>
                        <li><i class="fas fa-check-circle"></i> Secure, encrypted communications</li>
                        <li><i class="fas fa-check-circle"></i> Tutor background verification status</li>
                        <li><i class="fas fa-check-circle"></i> Emergency contact protocols</li>
                    </ul>
                </div>
            </div>
        </div>
    </section>

    <!-- How It Works -->
    <section class="how-it-works" id="how-it-works">
        <div class="container">
            <h2 class="section-title">Simple Steps to Get Started</h2>
            <p class="section-subtitle">
                Join hundreds of families who trust Baobab Academy with their children's education. 
                Getting started is simple, secure, and designed with busy parents in mind.
            </p>
            
            <div class="steps-container">
                <div class="step-card">
                    <div class="step-number">1</div>
                    <h3 class="step-title">Create Your Account</h3>
                    <p class="step-description">
                        Register with your family details and set up secure access to your personalized parent portal 
                        in just a few minutes.
                    </p>
                </div>
                
                <div class="step-card">
                    <div class="step-number">2</div>
                    <h3 class="step-title">Child Assessment & Matching</h3>
                    <p class="step-description">
                        Our team conducts a comprehensive assessment and matches your child with the perfect 
                        Nigeria-based tutor for their needs.
                    </p>
                </div>
                
                <div class="step-card">
                    <div class="step-number">3</div>
                    <h3 class="step-title">Begin Learning Journey</h3>
                    <p class="step-description">
                        Watch your child flourish through our portal as they engage in culturally-rich, 
                        academically excellent lessons.
                    </p>
                </div>
                
                <div class="step-card">
                    <div class="step-number">4</div>
                    <h3 class="step-title">Track & Celebrate Growth</h3>
                    <p class="step-description">
                        Monitor progress, communicate with tutors, and celebrate every milestone in your 
                        child's educational and cultural development.
                    </p>
                </div>
            </div>
        </div>
    </section>

    <!-- Security & Trust -->
    <section class="security-section" id="security">
        <div class="container">
            <div class="security-content">
                <div class="security-text">
                    <h2>Your Child's Safety is Our Priority</h2>
                    <p>
                        We understand that as a parent, nothing matters more than your child's safety and wellbeing. 
                        Our portal is built with the highest security standards and complete transparency.
                    </p>
                    <p>
                        Every interaction is monitored, every tutor is thoroughly vetted, and every lesson is 
                        recorded for your peace of mind. You have complete control and visibility.
                    </p>
                </div>
                
                <div class="security-features">
                    <div class="security-item">
                        <div class="security-icon">
                            <i class="fas fa-user-shield"></i>
                        </div>
                        <h4 class="security-item-title">Verified Tutors</h4>
                        <p class="security-item-desc">Background checked educators</p>
                    </div>
                    
                    <div class="security-item">
                        <div class="security-icon">
                            <i class="fas fa-lock"></i>
                        </div>
                        <h4 class="security-item-title">Encrypted Platform</h4>
                        <p class="security-item-desc">Bank-level security protocols</p>
                    </div>
                    
                    <div class="security-item">
                        <div class="security-icon">
                            <i class="fas fa-eye"></i>
                        </div>
                        <h4 class="security-item-title">Full Monitoring</h4>
                        <p class="security-item-desc">Complete session transparency</p>
                    </div>
                    
                    <div class="security-item">
                        <div class="security-icon">
                            <i class="fas fa-headset"></i>
                        </div>
                        <h4 class="security-item-title">24/7 Support</h4>
                        <p class="security-item-desc">Always here when you need us</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- CTA Section -->
    <section class="cta-section" id="register">
        <div class="container">
            <div class="cta-content">
                <h2 class="cta-title">Ready to Watch Your Child Flourish?</h2>
                <p class="cta-subtitle">
                    Join the growing community of families who choose Baobab Academy for academic excellence 
                    rooted in cultural pride. Your child's journey to limitless growth starts here.
                </p>
                <div class="cta-buttons">
                    <a href="#" class="btn btn-primary btn-hero" onclick="openRegistrationModal()">
                        <i class="fas fa-user-plus"></i>
                        Create Your Parent Account
                    </a>
                    <a href="#" class="btn btn-outlined btn-hero" onclick="openLoginModal()">
                        <i class="fas fa-sign-in-alt"></i>
                        Already Have an Account?
                    </a>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h4><i class="fas fa-heart"></i> Parent Resources</h4>
                    <a href="get-started.html" class="footer-link">Getting Started Guide</a>
                    <a href="supporting-child.html" class="footer-link">Supporting Your Child's Learning</a>
                    <a href="cultural-integration.html" class="footer-link">Cultural Integration at Home</a>
                </div>
                
                <div class="footer-section">
                    <h4><i class="fas fa-shield-alt"></i> Safety & Security</h4>
                    <a href="child-protection.html" class="footer-link">Child Protection Policy</a>
                    <a href="tutor-verification.html" class="footer-link">Tutor Verification Process</a>
                    <a href="#" class="footer-link">Platform Security Features</a>
                    <a href="#" class="footer-link">Privacy Policy</a>
                </div>
                
                <div class="footer-section">
                    <h4><i class="fas fa-headset"></i> Support</h4>
                    <p style="color: rgba(255, 255, 255, 0.7); margin-bottom: 15px;">
                        <i class="fas fa-envelope"></i>
                        parents@baobabonlineacademy.com
                    </p>
                    <p style="color: rgba(255, 255, 255, 0.7); margin-bottom: 15px;">
                        <i class="fas fa-phone"></i>
                        +234 (0) 816 501 1291
                    </p>
                    <a href="#" class="footer-link">Help Center</a>
                    <a href="#" class="footer-link">Live Chat Support</a>
                </div>
            </div>
            
            <div class="footer-bottom">
                <p>&copy; 2025 Baobab Online Academy Parent Portal. Nurturing Growth, Honoring Heritage!</p>
            </div>
        </div>
    </footer>

    <!-- Registration Modal -->
    <div class="modal" id="registrationModal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeRegistrationModal()">
                <i class="fas fa-times"></i>
            </button>
            
            <h3 class="modal-title">
                <i class="fas fa-user-plus"></i>
                Create Parent Account
            </h3>
            
            <div class="error-message" id="regErrorMessage"></div>
            <div class="success-message" id="regSuccessMessage"></div>
            
            <form id="registrationForm" onsubmit="handleRegistration(event)">
                <div class="form-group">
                    <label class="form-label">Email Address *</label>
                    <input type="email" name="email" required class="form-input" placeholder="Enter your email address">
                </div>
                
                <div class="form-group">
                    <label class="form-label">Full Name *</label>
                    <input type="text" name="full_name" required class="form-input" placeholder="Enter your full name">
                </div>
                
                <div class="form-group">
                    <label class="form-label">Phone Number *</label>
                    <input type="tel" name="phone" required class="form-input" placeholder="Enter your phone number">
                </div>
                
                <div class="form-group">
                    <label class="form-label">Password *</label>
                    <input type="password" name="password" required class="form-input" placeholder="Create a strong password" minlength="6">
                </div>
                
                <div class="form-group">
                    <label class="form-label">Confirm Password *</label>
                    <input type="password" name="confirmPassword" required class="form-input" placeholder="Confirm your password" minlength="6">
                </div>
                
                <button type="submit" class="form-submit" id="regSubmitBtn">
                    <span id="regSubmitText">Create Account</span>
                    <div class="loading-spinner" id="regLoadingSpinner"></div>
                </button>
            </form>
            
            <div class="form-toggle">
                Already have an account? <a href="#" onclick="switchToLogin()">Login here</a>
            </div>
        </div>
    </div>

    <!-- Login Modal -->
    <div class="modal" id="loginModal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeLoginModal()">
                <i class="fas fa-times"></i>
            </button>
            
            <h3 class="modal-title">
                <i class="fas fa-sign-in-alt"></i>
                Parent Login
            </h3>
            
            <div class="error-message" id="loginErrorMessage"></div>
            <div class="success-message" id="loginSuccessMessage"></div>
            
            <form id="loginForm" onsubmit="handleLogin(event)">
                <div class="form-group">
                    <label class="form-label">Email Address *</label>
                    <input type="email" name="email" required class="form-input" placeholder="Enter your email address">
                </div>
                
                <div class="form-group">
                    <label class="form-label">Password *</label>
                    <input type="password" name="password" required class="form-input" placeholder="Enter your password">
                </div>
                
                <button type="submit" class="form-submit" id="loginSubmitBtn">
                    <span id="loginSubmitText">Login</span>
                    <div class="loading-spinner" id="loginLoadingSpinner"></div>
                </button>
            </form>
            
            <div class="form-toggle">
                Don't have an account? <a href="#" onclick="switchToRegistration()">Register here</a>
            </div>
        </div>
    </div>

    <!-- Email Verification Modal -->
    <div class="modal" id="verificationModal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeVerificationModal()">
                <i class="fas fa-times"></i>
            </button>
            
            <div class="verification-notice">
                <div class="email-icon">
                    <i class="fas fa-envelope-open"></i>
                </div>
                <h4>📧 Check Your Email!</h4>
                <p><strong>We've sent a verification link to your email address.</strong></p>
                <p>Please check your inbox and click the verification link to activate your parent account.</p>
                <p style="font-size: 0.95rem; opacity: 0.9; margin-top: 20px;">
                    Don't see the email? Check your spam folder or 
                    <span class="resend-link" onclick="resendVerificationEmail()">
                        click here to resend
                    </span>
                </p>
            </div>
            
            <div style="text-align: center; margin-top: 25px;">
                <button class="btn btn-primary" onclick="closeVerificationModal()">
                    <i class="fas fa-check"></i>
                    I'll Check My Email
                </button>
            </div>
        </div>
    </div>

<script>
  // ===== CONFIGURATION SECTION =====
  const SUPABASE_URL = 'https://vcxdkacxbjsgaoxbhsip.supabase.co';
  const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZjeGRrYWN4YmpzZ2FveGJoc2lwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTI5MDQ5ODMsImV4cCI6MjA2ODQ4MDk4M30.T9KhHWzHZWyaZvyeFXtBu8tPLY9JOn6_wCHcH8B46FU';

  const EMAILJS_CONFIG = {
    PUBLIC_KEY: 'axzjFvaj8oDzIdLHB',
    SERVICE_ID: 'service_02brniu',
    TEMPLATE_ID: 'template_ijjrhov'
  };

  const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
  emailjs.init(EMAILJS_CONFIG.PUBLIC_KEY);

  let pendingUserData = null;

  // ===== MOBILE MENU FUNCTIONALITY =====
  const menuToggle = document.getElementById('menuToggle');
  const mobileMenuPanel = document.getElementById('mobileMenuPanel');
  const menuOverlay = document.getElementById('menuOverlay');

  function toggleMenu() {
    mobileMenuPanel.classList.toggle('active');
    menuOverlay.classList.toggle('active');
    document.body.style.overflow = mobileMenuPanel.classList.contains('active') ? 'hidden' : 'auto';
    menuToggle.innerHTML = mobileMenuPanel.classList.contains('active') ? '<i class="fas fa-times"></i>' : '<i class="fas fa-bars"></i>';
  }

  function closeMenu() {
    mobileMenuPanel.classList.remove('active');
    menuOverlay.classList.remove('active');
    document.body.style.overflow = 'auto';
    menuToggle.innerHTML = '<i class="fas fa-bars"></i>';
  }

  menuToggle.addEventListener('click', toggleMenu);
  menuOverlay.addEventListener('click', closeMenu);
  document.querySelectorAll('.mobile-link').forEach(link => link.addEventListener('click', closeMenu));

  // ===== MODAL FUNCTIONS =====
  function openRegistrationModal() {
    document.getElementById('registrationModal').style.display = 'flex';
    document.body.style.overflow = 'hidden';
    clearMessages();
  }

  function closeRegistrationModal() {
    document.getElementById('registrationModal').style.display = 'none';
    document.body.style.overflow = 'auto';
    clearMessages();
  }

  function openLoginModal() {
    document.getElementById('loginModal').style.display = 'flex';
    document.body.style.overflow = 'hidden';
    clearMessages();
  }

  function closeLoginModal() {
    document.getElementById('loginModal').style.display = 'none';
    document.body.style.overflow = 'auto';
    clearMessages();
  }

  function openVerificationModal() {
    document.getElementById('verificationModal').style.display = 'flex';
    document.body.style.overflow = 'hidden';
  }

  function closeVerificationModal() {
    document.getElementById('verificationModal').style.display = 'none';
    document.body.style.overflow = 'auto';
  }

  function switchToLogin() {
    closeRegistrationModal();
    openLoginModal();
  }

  function switchToRegistration() {
    closeLoginModal();
    openRegistrationModal();
  }

  function clearMessages() {
    document.querySelectorAll('.error-message').forEach(msg => {
      msg.style.display = 'none';
      msg.textContent = '';
    });
    document.querySelectorAll('.success-message').forEach(msg => {
      msg.style.display = 'none';
      msg.textContent = '';
    });
  }

  function showError(elementId, message) {
    const el = document.getElementById(elementId);
    el.textContent = message;
    el.style.display = 'block';
  }

  function showSuccess(elementId, message) {
    const el = document.getElementById(elementId);
    el.textContent = message;
    el.style.display = 'block';
  }

  // ===== IMPROVED EMAIL VERIFICATION FUNCTIONS =====
  
  // Generate custom verification token and send via EmailJS
  async function generateCustomVerificationToken(email) {
    try {
      const { data, error } = await supabase.rpc('generate_verification_token', {
        p_email: email.toLowerCase()
      });

      if (error) {
        console.error('Token generation error:', error);
        return null;
      }

      return data;
    } catch (err) {
      console.error('Token generation exception:', err);
      return null;
    }
  }

  // Send verification email with retry logic
  async function sendVerificationEmailWithRetry(userData, maxRetries = 3) {
    for (let attempt = 1; attempt <= maxRetries; attempt++) {
      console.log(`EmailJS attempt ${attempt}/${maxRetries}`);
      
      try {
        // Generate custom verification token
        const token = await generateCustomVerificationToken(userData.email);
        if (!token) {
          throw new Error('Failed to generate verification token');
        }

        // Create verification link with custom token
        const verificationLink = `${window.location.origin}/verify-email.html?token=${token}&email=${encodeURIComponent(userData.email)}`;

        const emailData = {
          to_email: userData.email,
          to_name: userData.fullName,
          from_name: 'Baobab Online Academy Parent Portal',
          subject: 'Welcome to Baobab Parent Portal - Please Verify Your Email',
          parent_name: userData.fullName,
          verification_link: verificationLink,
          portal_url: window.location.origin,
          support_email: 'parents@baobabonlineacademy.com',
          current_year: new Date().getFullYear()
        };

        // Send with longer timeout and proper error handling
        const result = await Promise.race([
          emailjs.send(EMAILJS_CONFIG.SERVICE_ID, EMAILJS_CONFIG.TEMPLATE_ID, emailData),
          new Promise((_, reject) => 
            setTimeout(() => reject(new Error('EmailJS timeout')), 30000) // 30 second timeout
          )
        ]);

        console.log('EmailJS success:', result);
        return true;

      } catch (error) {
        console.error(`EmailJS attempt ${attempt} failed:`, error);
        
        if (attempt === maxRetries) {
          return false;
        }
        
        // Wait before retry (exponential backoff)
        await new Promise(resolve => setTimeout(resolve, 1000 * attempt));
      }
    }
    return false;
  }

  // Fallback: Generate Supabase link (backup method)
  async function generateSupabaseVerificationLink(email) {
    try {
      const { data, error } = await supabase.functions.invoke('smooth-responder', {
        body: {
          email,
          redirectTo: `${window.location.origin}/verify-email.html`
        }
      });

      if (error || !data?.link) {
        console.error('Supabase link generation failed:', error);
        return null;
      }
      return data.link;
    } catch (err) {
      console.error('Supabase link generation error:', err);
      return null;
    }
  }

  async function resendVerificationEmail() {
    if (!pendingUserData) {
      alert('No pending verification found. Please try registering again.');
      return;
    }

    try {
      const success = await sendVerificationEmailWithRetry(pendingUserData);
      if (success) {
        alert('Verification email resent successfully! Please check your inbox.');
      } else {
        alert('Failed to resend verification email. Please contact support.');
      }
    } catch (error) {
      console.error('Resend error:', error);
      alert('Failed to resend verification email. Please try again.');
    }
  }

  // ===== IMPROVED REGISTRATION FUNCTION =====
  async function handleRegistration(event) {
    event.preventDefault();

    const submitBtn = document.getElementById('regSubmitBtn');
    const submitText = document.getElementById('regSubmitText');
    const loadingSpinner = document.getElementById('regLoadingSpinner');

    submitText.style.display = 'none';
    loadingSpinner.style.display = 'inline-block';
    submitBtn.disabled = true;
    clearMessages();

    try {
      const formData = new FormData(event.target);
      const email = (formData.get('email') || '').toLowerCase().trim();
      const fullName = (formData.get('full_name') || '').trim();
      const phone = (formData.get('phone') || '').trim();
      const password = formData.get('password');
      const confirmPassword = formData.get('confirmPassword');

      if (password !== confirmPassword) {
        throw new Error('Passwords do not match');
      }

      // Check authorized email
      const { data: authorizedEmail, error: authCheckError } = await supabase
        .from('authorised_emails')
        .select('*')
        .eq('email', email)
        .eq('is_used', false)
        .single();

      if (authCheckError || !authorizedEmail) {
        throw new Error('This email is not authorized to create an account. Please contact support at parents@baobabonlineacademy.com');
      }

      // Create user account WITHOUT email confirmation (we'll handle it manually)
      const { data: authData, error: signUpError } = await supabase.auth.signUp({
        email,
        password,
        options: {
          emailRedirectTo: `${window.location.origin}/verify-email.html`,
          data: { 
            full_name: fullName, 
            phone: phone 
          }
        }
      });

      if (signUpError) {
        throw new Error(signUpError.message);
      }

      if (!authData.user) {
        throw new Error('Failed to create user account');
      }

      // Store user data for verification
      pendingUserData = {
        email,
        fullName,
        phone,
        userId: authData.user.id
      };

      // Send verification email via EmailJS
      console.log('Sending verification email via EmailJS...');
      const emailSent = await sendVerificationEmailWithRetry(pendingUserData);

      if (!emailSent) {
        throw new Error('Failed to send verification email. Please try again or contact support.');
      }

      // Mark email as used only after successful email sending
      const { error: updateError } = await supabase
        .from('authorised_emails')
        .update({ 
          is_used: true, 
          used_at: new Date().toISOString(),
          used_by_user_id: authData.user.id 
        })
        .eq('email', email);

      if (updateError) {
        console.error('Failed to update authorised_emails:', updateError);
        // Don't throw error here as email was sent successfully
      }

      // Reset form and show verification modal
      event.target.reset();
      closeRegistrationModal();
      openVerificationModal();

      console.log('Registration completed successfully');

    } catch (error) {
      console.error('Registration error:', error);
      showError('regErrorMessage', error.message || 'Registration failed. Please try again.');
    } finally {
      submitText.style.display = 'inline';
      loadingSpinner.style.display = 'none';
      submitBtn.disabled = false;
    }
  }

  // ===== LOGIN FUNCTION =====
  async function handleLogin(event) {
    event.preventDefault();

    const submitBtn = document.getElementById('loginSubmitBtn');
    const submitText = document.getElementById('loginSubmitText');
    const loadingSpinner = document.getElementById('loginLoadingSpinner');

    submitText.style.display = 'none';
    loadingSpinner.style.display = 'inline-block';
    submitBtn.disabled = true;
    clearMessages();

    try {
      const formData = new FormData(event.target);
      const email = (formData.get('email') || '').toLowerCase().trim();
      const password = formData.get('password');

      const { data: authData, error: signInError } = await supabase.auth.signInWithPassword({
        email,
        password
      });

      if (signInError) {
        throw new Error(signInError.message);
      }

      // Check if email is verified through our custom verification
      const { data: profile, error: profileError } = await supabase
        .from('parent_profiles')
        .select('email_verified')
        .eq('user_id', authData.user.id)
        .single();

      if (profileError || !profile?.email_verified) {
        showError('loginErrorMessage', 'Please verify your email address before logging in. Check your inbox for the verification link.');
        return;
      }

      showSuccess('loginSuccessMessage', 'Login successful! Redirecting to your dashboard...');
      event.target.reset();

      setTimeout(() => {
        closeLoginModal();
        window.location.href = '/parent-dashboard.html';
      }, 2000);

    } catch (error) {
      console.error('Login error:', error);
      showError('loginErrorMessage', error.message || 'Login failed. Please try again.');
    } finally {
      submitText.style.display = 'inline';
      loadingSpinner.style.display = 'none';
      submitBtn.disabled = false;
    }
  }

  // ===== CHECK AUTHENTICATION STATUS =====
  async function checkAuthStatus() {
    const { data: { user } } = await supabase.auth.getUser();
    if (user) {
      console.log('User session found:', user);
    }
  }

  // ===== SMOOTH SCROLLING =====
  document.querySelectorAll('a[href^="#"]').forEach(anchor => {
    anchor.addEventListener('click', function (e) {
      const href = this.getAttribute('href');
      if (href === '#' || href === '#login' || href === '#register') {
        e.preventDefault();
        return;
      }
      e.preventDefault();
      const target = document.querySelector(href);
      if (target) target.scrollIntoView({ behavior: 'smooth', block: 'start' });
    });
  });

  // ===== INTERACTIVE EFFECTS =====
  document.querySelectorAll('.feature-card').forEach(card => {
    card.addEventListener('mouseenter', function () {
      this.style.transform = 'translateY(-15px) scale(1.02)';
    });
    card.addEventListener('mouseleave', function () {
      this.style.transform = 'translateY(0) scale(1)';
    });
  });

  // ===== CLOSE MODALS ON OUTSIDE CLICK =====
  document.getElementById('registrationModal').addEventListener('click', (e) => {
    if (e.target === e.currentTarget) closeRegistrationModal();
  });
  document.getElementById('loginModal').addEventListener('click', (e) => {
    if (e.target === e.currentTarget) closeLoginModal();
  });
  document.getElementById('verificationModal').addEventListener('click', (e) => {
    if (e.target === e.currentTarget) closeVerificationModal();
  });

  // ===== INITIALIZE ON PAGE LOAD =====
  document.addEventListener('DOMContentLoaded', function () {
    checkAuthStatus();
  });

  // Expose functions used by HTML attributes
  window.openRegistrationModal = openRegistrationModal;
  window.closeRegistrationModal = closeRegistrationModal;
  window.openLoginModal = openLoginModal;
  window.closeLoginModal = closeLoginModal;
  window.openVerificationModal = openVerificationModal;
  window.closeVerificationModal = closeVerificationModal;
  window.switchToLogin = switchToLogin;
  window.switchToRegistration = switchToRegistration;
  window.resendVerificationEmail = resendVerificationEmail;
  window.handleRegistration = handleRegistration;
  window.handleLogin = handleLogin;
</script>
</body>
</html>
